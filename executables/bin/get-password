#!/bin/sh
set -e

VAULT="Private"
CREDENTIAL=""

main() {
	parse_args "$@"
	op read "op://$VAULT/$CREDENTIAL/password"
}

parse_args() {
	while [ $# -gt 0 ]; do
		case "$1" in
		--vault)
			VAULT="$2"
			shift 2
			;;
		--credential)
			CREDENTIAL="$2"
			shift 2
			;;
		*)
			echo "Usage: $0 [--vault <name>] --credential <name>"
			exit 1
			;;
		esac
	done

	if [ -z "$CREDENTIAL" ]; then
		echo "Invalid or empty CREDENTIAL" >&2
		exit 1
	fi
}

main "$@"
